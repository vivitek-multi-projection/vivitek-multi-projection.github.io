"use strict";(self["webpackChunkmps"]=self["webpackChunkmps"]||[]).push([[639],{52934:(e,t,o)=>{o.d(t,{OO:()=>i,jT:()=>s});const i={m:1,cm:100,mm:1e3,inch:39.3700787,feet:3.2808399},s={plane:0,curved:1,sphere:2,custom:3}},63898:(e,t,o)=>{o.d(t,{u:()=>i});class i{constructor(){this.uId="",this.customName="",this.modelName="",this.lensName="",this.aspectRatio=0,this.imageAspectRatio=0,this.offset=0,this.texture="",this.throwRatio=0,this.throwRatioMin=0,this.throwRatioMax=0,this.x=0,this.y=0,this.z=0,this.projectionDistance=0,this.rotateX=0,this.rotateY=0,this.rotateZ=0,this.lensShiftH=0,this.lensShiftHMin=0,this.lensShiftHMax=0,this.lensShiftV=0,this.lensShiftVMin=0,this.lensShiftVMax=0,this.isShowBlendingGuideLine=!1,this.blendingGuideLineL=0,this.blendingGuideLineR=0,this.blendingGuideLineT=0,this.blendingGuideLineB=0,this.resolutionX=0,this.resolutionY=0}}},39639:(e,t,o)=>{o.r(t),o.d(t,{default:()=>jt});var i=o(83673);const s=(0,i.HX)("data-v-10d8ae1e");(0,i.dD)("data-v-10d8ae1e");const r={class:"fit",id:"threeView"};(0,i.Cn)();const n=s(((e,t,o,n,l,a)=>{const c=(0,i.up)("ProjectorDetail"),d=(0,i.up)("q-resize-observer"),h=(0,i.up)("q-page");return(0,i.wg)(),(0,i.j4)(h,{class:"flex flex-center","style-fn":a.stylePage},{default:s((()=>[(0,i.Wm)("div",r,[(0,i.Wm)(c),(0,i.Wm)(d,{onResize:a.resizeCanvas,debounce:"100"},null,8,["onResize"])])])),_:1},8,["style-fn"])}));var l=o(90515),a=o.n(l),c=o(87874),d=o(62323),h=o(98880);const m=(0,i.HX)("data-v-0eb4e03f");(0,i.dD)("data-v-0eb4e03f");const u={class:"absolute absolute-bottom-left detail-wrapper"},_={class:"row"},p={class:"col-5",id:"projector-detail-settings"},j={class:"row items-center no-wrap"},S={class:"col"},v={class:"text-subtitle2 flex"},P={style:{margin:"auto 5px","white-space":"nowrap","text-overflow":"ellipsis",overflow:"hidden","max-width":"100px"}},b={class:"col-auto"},g={class:"col-auto"},E={class:"q-gutter-sm row"},f=(0,i.Wm)("div",{class:"text-subtitle2"}," X: ",-1),R={style:{width:"250px"},class:"q-pl-sm q-pr-sm row"},w={class:"col-10"},T={class:"col"},y=(0,i.Wm)("div",{class:"text-subtitle2"}," Y: ",-1),x={style:{width:"250px"},class:"q-pl-sm q-pr-sm row"},L={class:"col-10"},C={class:"col"},O=(0,i.Wm)("div",{class:"text-subtitle2"}," Z: ",-1),z={style:{width:"250px"},class:"q-pl-sm q-pr-sm row"},B={class:"text-subtitle2"},W={style:{width:"250px"},class:"q-pl-sm q-pr-sm row"},D={class:"col-10"},I={class:"col"},M={class:"text-subtitle2"},V={style:{width:"250px"},class:"q-pl-sm q-pr-sm row"},$={class:"col-10"},A={class:"col"},G={class:"text-subtitle2"},U={style:{width:"250px"},class:"q-pl-sm q-pr-sm row"},q={class:"col-10"},k={class:"col"},J={class:"q-gutter-sm row"},N={class:"text-subtitle2"},H={class:"text-subtitle2"},Z={style:{width:"250px"},class:"q-pl-sm q-pr-sm row"},X={class:"col-10"},Y={class:"col"},F={class:"text-subtitle2"},Q={style:{width:"250px"},class:"q-pl-sm q-pr-sm row"},K={class:"col-10"},ee={class:"col"},te={class:"text-subtitle2"},oe={style:{width:"250px"},class:"q-pl-sm q-pr-sm row"},ie={class:"col-10"},se={class:"col"},re={class:"q-gutter-sm row"},ne={class:"text-subtitle2"},le={style:{width:"250px"},class:"q-pl-sm q-pr-sm row"},ae={class:"col-10"},ce={class:"col"},de={class:"text-subtitle2"},he={class:"text-subtitle2"},me={style:{width:"250px"},class:"q-pl-sm q-pr-sm row"},ue={class:"col-10"},_e={class:"col"},pe={class:"text-subtitle2"},je={class:"text-subtitle2"},Se={style:{width:"250px"},class:"q-pl-sm q-pr-sm row"},ve={class:"col-10"},Pe={class:"col"},be={class:"text-subtitle2"},ge={class:"text-subtitle2"},Ee={style:{width:"250px"},class:"q-pl-sm q-pr-sm row"},fe={class:"col-10"},Re={class:"col"},we={class:"text-subtitle2"},Te={key:0,class:"text-subtitle2 text-center"},ye={key:1,class:"text-subtitle2 text-center"},xe={class:"q-gutter-sm row"},Le=(0,i.Wm)("div",{class:"text-subtitle2"}," x: ",-1),Ce={class:"col-7",id:"projector-detail-list"},Oe={class:"q-pa-none"},ze={key:0,style:{color:"#2196f3"}},Be={key:1};(0,i.Cn)();const We=m(((e,t,o,s,r,n)=>{const l=(0,i.up)("q-btn"),a=(0,i.up)("q-tab"),c=(0,i.up)("q-tabs"),We=(0,i.up)("q-card-section"),De=(0,i.up)("q-separator"),Ie=(0,i.up)("q-slider"),Me=(0,i.up)("q-input"),Ve=(0,i.up)("q-tab-panel"),$e=(0,i.up)("q-select"),Ae=(0,i.up)("q-checkbox"),Ge=(0,i.up)("q-tab-panels"),Ue=(0,i.up)("q-td"),qe=(0,i.up)("q-table"),ke=(0,i.up)("q-card");return(0,i.wy)(((0,i.wg)(),(0,i.j4)("div",u,[n.selectedProjector?((0,i.wg)(),(0,i.j4)(ke,{key:0,class:"fit"},{default:m((()=>[(0,i.Wm)("div",_,[(0,i.Wm)("div",p,[(0,i.Wm)(We,{class:"q-pa-none q-pl-md q-pr-xs"},{default:m((()=>[(0,i.Wm)("div",j,[(0,i.Wm)("div",S,[(0,i.Wm)("div",v,[(0,i.Wm)("span",P,(0,d.zw)(`${n.selectedProjector.customName}`),1),(0,i.Wm)(l,{color:"primary",flat:"",size:"sm",padding:"none",outline:"",icon:"file_copy",onClick:n.copyProjector},null,8,["onClick"])])]),(0,i.Wm)("div",b,[(0,i.Wm)(c,{modelValue:r.tab,"onUpdate:modelValue":t[1]||(t[1]=e=>r.tab=e),dense:"","active-color":"primary","indicator-color":"primary",align:"justify","narrow-indicator":""},{default:m((()=>[(0,i.Wm)(a,{name:"position",label:e.$t("position")},null,8,["label"]),(0,i.Wm)(a,{name:"projection",label:e.$t("projection")},null,8,["label"]),(0,i.Wm)(a,{name:"blending",label:e.$t("blending")},null,8,["label"]),(0,i.Wm)(a,{name:"layout",label:e.$t("layout")},null,8,["label"])])),_:1},8,["modelValue"])]),(0,i.Wm)("div",g,[(0,i.Wm)(l,{color:"grey-7",round:"",flat:"",icon:"arrow_drop_down",onClick:t[2]||(t[2]=e=>n.showProjectorDetail=!1)})])])])),_:1}),(0,i.Wm)(De),(0,i.Wm)(We,{class:"q-pa-none",style:{height:"200px",overflow:"auto"}},{default:m((()=>[(0,i.Wm)(Ge,{modelValue:r.tab,"onUpdate:modelValue":t[16]||(t[16]=e=>r.tab=e),animated:""},{default:m((()=>[(0,i.Wm)(Ve,{name:"position"},{default:m((()=>[(0,i.Wm)("div",E,[(0,i.Wm)(Me,{"model-value":n.selectedProjector.x,"onUpdate:modelValue":n.setX,suffix:n.unitLabel,title:`${n.selectedProjector.x}${n.unitLabel}`,dense:"",color:e.$q.dark.isActive?"primary":"positive",type:"number",step:"0.1",style:{width:"95%"}},{prepend:m((()=>[f])),append:m((()=>[(0,i.Wm)("div",R,[(0,i.Wm)("div",w,[(0,i.Wm)(Ie,{"model-value":n.selectedProjector.x,"onUpdate:modelValue":n.setX,step:.1*n.unitRatio,min:-15*n.unitRatio,max:15*n.unitRatio},null,8,["model-value","onUpdate:modelValue","step","min","max"])]),(0,i.Wm)("div",T,[(0,i.Wm)(l,{flat:"",color:"primary",onClick:t[3]||(t[3]=()=>{n.setX(0)}),icon:"refresh"})])])])),_:1},8,["model-value","onUpdate:modelValue","suffix","title","color"]),(0,i.Wm)(Me,{"model-value":n.selectedProjector.y,"onUpdate:modelValue":n.setY,suffix:n.unitLabel,title:`${n.selectedProjector.y}${n.unitLabel}`,dense:"",color:e.$q.dark.isActive?"primary":"positive",type:"number",step:"0.1",style:{width:"95%"}},{prepend:m((()=>[y])),append:m((()=>[(0,i.Wm)("div",x,[(0,i.Wm)("div",L,[(0,i.Wm)(Ie,{"model-value":n.selectedProjector.y,"onUpdate:modelValue":n.setY,step:.1*n.unitRatio,min:-10*n.unitRatio,max:10*n.unitRatio},null,8,["model-value","onUpdate:modelValue","step","min","max"])]),(0,i.Wm)("div",C,[(0,i.Wm)(l,{flat:"",color:"primary",onClick:t[4]||(t[4]=()=>{n.setY(0)}),icon:"refresh"})])])])),_:1},8,["model-value","onUpdate:modelValue","suffix","title","color"]),(0,i.Wm)(Me,{"model-value":n.selectedProjector.z,"onUpdate:modelValue":n.setZ,title:`${n.selectedProjector.z}${n.unitLabel}`,dense:"",color:e.$q.dark.isActive?"primary":"positive",type:"number",step:"0.1",suffix:n.unitLabel,style:{width:"95%"}},{prepend:m((()=>[O])),append:m((()=>[(0,i.Wm)("div",z,[(0,i.Wm)(Ie,{"model-value":n.selectedProjector.z,"onUpdate:modelValue":n.setZ,step:.1*n.unitRatio,min:0,max:20*n.unitRatio},null,8,["model-value","onUpdate:modelValue","step","max"])])])),_:1},8,["model-value","onUpdate:modelValue","title","color","suffix"]),(0,i.Wm)(Me,{"model-value":n.selectedProjector.rotateX,"onUpdate:modelValue":n.setRotateX,title:`${n.selectedProjector.rotateX}°`,dense:"",color:e.$q.dark.isActive?"primary":"positive",type:"number",step:"2",min:"-180",max:"180",suffix:"°",style:{width:"95%"}},{prepend:m((()=>[(0,i.Wm)("div",B,(0,d.zw)(e.$t("rotateX"))+": ",1)])),append:m((()=>[(0,i.Wm)("div",W,[(0,i.Wm)("div",D,[(0,i.Wm)(Ie,{"model-value":n.selectedProjector.rotateX,"onUpdate:modelValue":n.setRotateX,min:-180,max:180},null,8,["model-value","onUpdate:modelValue"])]),(0,i.Wm)("div",I,[(0,i.Wm)(l,{flat:"",color:"primary",onClick:t[5]||(t[5]=()=>{n.setRotateX(0)}),icon:"refresh"})])])])),_:1},8,["model-value","onUpdate:modelValue","title","color"]),(0,i.Wm)(Me,{"model-value":n.selectedProjector.rotateY,"onUpdate:modelValue":n.setRotateY,title:`${n.selectedProjector.rotateY}°`,dense:"",color:e.$q.dark.isActive?"primary":"positive",type:"number",step:"2",min:"-180",max:"180",suffix:"°",style:{width:"95%"}},{prepend:m((()=>[(0,i.Wm)("div",M,(0,d.zw)(e.$t("rotateY"))+": ",1)])),append:m((()=>[(0,i.Wm)("div",V,[(0,i.Wm)("div",$,[(0,i.Wm)(Ie,{"model-value":n.selectedProjector.rotateY,"onUpdate:modelValue":n.setRotateY,min:-180,max:180},null,8,["model-value","onUpdate:modelValue"])]),(0,i.Wm)("div",A,[(0,i.Wm)(l,{flat:"",color:"primary",onClick:t[6]||(t[6]=()=>{n.setRotateY(0)}),icon:"refresh"})])])])),_:1},8,["model-value","onUpdate:modelValue","title","color"]),(0,i.Wm)(Me,{"model-value":n.selectedProjector.rotateZ,"onUpdate:modelValue":n.setRotateZ,title:`${n.selectedProjector.rotateZ}°`,dense:"",color:e.$q.dark.isActive?"primary":"positive",type:"number",step:"2",min:"-180",max:"180",suffix:"°",style:{width:"95%"}},{prepend:m((()=>[(0,i.Wm)("div",G,(0,d.zw)(e.$t("rotateZ"))+": ",1)])),append:m((()=>[(0,i.Wm)("div",U,[(0,i.Wm)("div",q,[(0,i.Wm)(Ie,{"model-value":n.selectedProjector.rotateZ,"onUpdate:modelValue":n.setRotateZ,min:-180,max:180},null,8,["model-value","onUpdate:modelValue"])]),(0,i.Wm)("div",k,[(0,i.Wm)(l,{flat:"",color:"primary",onClick:t[7]||(t[7]=()=>{n.setRotateZ(0)}),icon:"refresh"})])])])),_:1},8,["model-value","onUpdate:modelValue","title","color"])])])),_:1}),(0,i.Wm)(Ve,{name:"projection"},{default:m((()=>[(0,i.Wm)("div",J,[(0,i.Wm)($e,{dense:"","model-value":n.selectedProjector.imageAspectRatio,"onUpdate:modelValue":n.changeImageAspectRatio,options:r.aspectRatios,color:e.$q.dark.isActive?"primary":"positive","emit-value":"","map-options":"","option-value":"value","option-label":"label",style:{width:"185px"},behavior:"menu"},{prepend:m((()=>[(0,i.Wm)("div",N,(0,d.zw)(e.$t("aspectRatio"))+": ",1)])),_:1},8,["model-value","onUpdate:modelValue","options","color"]),(0,i.wy)((0,i.Wm)(Me,{"model-value":n.selectedProjector.lensShiftH,"onUpdate:modelValue":n.setLensShiftH,title:`${n.selectedProjector.lensShiftH}%`,dense:"",color:e.$q.dark.isActive?"primary":"positive",type:"number",min:n.selectedProjector.lensShiftHMin,max:n.selectedProjector.lensShiftHMax,step:"1",suffix:"%",style:{"min-width":"400px"}},{prepend:m((()=>[(0,i.Wm)("div",H,(0,d.zw)(e.$t("lensShiftH"))+": ",1)])),append:m((()=>[(0,i.Wm)("div",Z,[(0,i.Wm)("div",X,[(0,i.Wm)(Ie,{"model-value":n.selectedProjector.lensShiftH,"onUpdate:modelValue":n.setLensShiftH,min:n.selectedProjector.lensShiftHMin,max:n.selectedProjector.lensShiftHMax},null,8,["model-value","onUpdate:modelValue","min","max"])]),(0,i.Wm)("div",Y,[(0,i.Wm)(l,{flat:"",color:"primary",onClick:t[8]||(t[8]=()=>{n.setLensShiftH(0)}),icon:"refresh"})])])])),_:1},8,["model-value","onUpdate:modelValue","title","color","min","max"]),[[h.F8,!(0===n.selectedProjector.lensShiftHMin&&0===n.selectedProjector.lensShiftHMax)]]),(0,i.wy)((0,i.Wm)(Me,{"model-value":n.selectedProjector.lensShiftV,"onUpdate:modelValue":n.setLensShiftV,title:`${n.selectedProjector.lensShiftV}%`,dense:"",color:e.$q.dark.isActive?"primary":"positive",type:"number",min:n.selectedProjector.lensShiftVMin,max:n.selectedProjector.lensShiftVMax,step:"1",suffix:"%",style:{"min-width":"400px"}},{prepend:m((()=>[(0,i.Wm)("div",F,(0,d.zw)(e.$t("lensShiftV"))+": ",1)])),append:m((()=>[(0,i.Wm)("div",Q,[(0,i.Wm)("div",K,[(0,i.Wm)(Ie,{"model-value":n.selectedProjector.lensShiftV,"onUpdate:modelValue":n.setLensShiftV,min:n.selectedProjector.lensShiftVMin,max:n.selectedProjector.lensShiftVMax},null,8,["model-value","onUpdate:modelValue","min","max"])]),(0,i.Wm)("div",ee,[(0,i.Wm)(l,{flat:"",color:"primary",onClick:t[9]||(t[9]=()=>{n.setLensShiftV(0)}),icon:"refresh"})])])])),_:1},8,["model-value","onUpdate:modelValue","title","color","min","max"]),[[h.F8,!(0===n.selectedProjector.lensShiftHMin&&0===n.selectedProjector.lensShiftHMax)]]),(0,i.Wm)(Me,{disable:n.selectedProjector.throwRatioMin===n.selectedProjector.throwRatio&&n.selectedProjector.throwRatioMax===n.selectedProjector.throwRatio,"model-value":n.selectedProjector.throwRatio,"onUpdate:modelValue":n.setThrowRatio,title:`${n.selectedProjector.throwRatio}`,dense:"",color:e.$q.dark.isActive?"primary":"positive",type:"number",min:n.selectedProjector.throwRatioMin,max:n.selectedProjector.throwRatioMax,step:"0.1",style:{"min-width":"400px"}},{prepend:m((()=>[(0,i.Wm)("div",te,(0,d.zw)(e.$t("throwRatio"))+": ",1)])),append:m((()=>[(0,i.Wm)("div",oe,[(0,i.Wm)("div",ie,[(0,i.Wm)(Ie,{"model-value":n.selectedProjector.throwRatio,"onUpdate:modelValue":n.setThrowRatio,step:.01,min:n.selectedProjector.throwRatioMin,max:n.selectedProjector.throwRatioMax},null,8,["model-value","onUpdate:modelValue","step","min","max"])]),(0,i.Wm)("div",se,[(0,i.Wm)(l,{flat:"",color:"primary",onClick:t[10]||(t[10]=()=>{n.setThrowRatio(n.selectedProjector.throwRatioMin)}),icon:"refresh"})])])])),_:1},8,["disable","model-value","onUpdate:modelValue","title","color","min","max"])])])),_:1}),(0,i.Wm)(Ve,{name:"blending"},{default:m((()=>[(0,i.Wm)("div",re,[(0,i.Wm)(Ae,{"model-value":n.selectedProjector.isShowBlendingGuideLine,"onUpdate:modelValue":n.setShowBlendingGuideLine,"left-label":"",label:"Blending Guide Line"},null,8,["model-value","onUpdate:modelValue"]),(0,i.Wm)(Me,{disable:!n.selectedProjector.isShowBlendingGuideLine,"model-value":n.selectedProjector.blendingGuideLineL,"onUpdate:modelValue":n.setBlendingGuideLineL,dense:"",color:e.$q.dark.isActive?"primary":"positive",type:"number",step:"2",min:"0",max:"100",suffix:"°",style:{width:"95%"}},{prepend:m((()=>[(0,i.Wm)("div",ne,(0,d.zw)(e.$t("left"))+": ",1)])),append:m((()=>[(0,i.Wm)("div",le,[(0,i.Wm)("div",ae,[(0,i.Wm)(Ie,{"model-value":n.selectedProjector.blendingGuideLineL,"onUpdate:modelValue":n.setBlendingGuideLineL,min:0,max:100},null,8,["model-value","onUpdate:modelValue"])]),(0,i.Wm)("div",ce,[(0,i.Wm)(l,{flat:"",color:"primary",onClick:t[11]||(t[11]=()=>{n.setBlendingGuideLineL(0)}),icon:"refresh"})])]),(0,i.Wm)("div",de,(0,d.zw)(`${n.blendingLeftPixel} ${e.$t("pixel")}`)+": ",1)])),_:1},8,["disable","model-value","onUpdate:modelValue","color"]),(0,i.Wm)(Me,{disable:!n.selectedProjector.isShowBlendingGuideLine,"model-value":n.selectedProjector.blendingGuideLineR,"onUpdate:modelValue":n.setBlendingGuideLineR,dense:"",color:e.$q.dark.isActive?"primary":"positive",type:"number",step:"2",min:"0",max:"100",suffix:"°",style:{width:"95%"}},{prepend:m((()=>[(0,i.Wm)("div",he,(0,d.zw)(e.$t("right"))+": ",1)])),append:m((()=>[(0,i.Wm)("div",me,[(0,i.Wm)("div",ue,[(0,i.Wm)(Ie,{"model-value":n.selectedProjector.blendingGuideLineR,"onUpdate:modelValue":n.setBlendingGuideLineR,min:0,max:100},null,8,["model-value","onUpdate:modelValue"])]),(0,i.Wm)("div",_e,[(0,i.Wm)(l,{flat:"",color:"primary",onClick:t[12]||(t[12]=()=>{n.setBlendingGuideLineR(0)}),icon:"refresh"})])]),(0,i.Wm)("div",pe,(0,d.zw)(`${n.blendingRightPixel} ${e.$t("pixel")}`)+": ",1)])),_:1},8,["disable","model-value","onUpdate:modelValue","color"]),(0,i.Wm)(Me,{disable:!n.selectedProjector.isShowBlendingGuideLine,"model-value":n.selectedProjector.blendingGuideLineT,"onUpdate:modelValue":n.setBlendingGuideLineT,dense:"",color:e.$q.dark.isActive?"primary":"positive",type:"number",step:"2",min:"0",max:"100",suffix:"°",style:{width:"95%"}},{prepend:m((()=>[(0,i.Wm)("div",je,(0,d.zw)(e.$t("top"))+": ",1)])),append:m((()=>[(0,i.Wm)("div",Se,[(0,i.Wm)("div",ve,[(0,i.Wm)(Ie,{"model-value":n.selectedProjector.blendingGuideLineT,"onUpdate:modelValue":n.setBlendingGuideLineT,min:0,max:100},null,8,["model-value","onUpdate:modelValue"])]),(0,i.Wm)("div",Pe,[(0,i.Wm)(l,{flat:"",color:"primary",onClick:t[13]||(t[13]=()=>{n.setBlendingGuideLineT(0)}),icon:"refresh"})])]),(0,i.Wm)("div",be,(0,d.zw)(`${n.blendingTopPixel} ${e.$t("pixel")}`)+": ",1)])),_:1},8,["disable","model-value","onUpdate:modelValue","color"]),(0,i.Wm)(Me,{disable:!n.selectedProjector.isShowBlendingGuideLine,"model-value":n.selectedProjector.blendingGuideLineB,"onUpdate:modelValue":n.setBlendingGuideLineB,dense:"",color:e.$q.dark.isActive?"primary":"positive",type:"number",step:"2",min:"0",max:"100",suffix:"°",style:{width:"95%"}},{prepend:m((()=>[(0,i.Wm)("div",ge,(0,d.zw)(e.$t("bottom"))+": ",1)])),append:m((()=>[(0,i.Wm)("div",Ee,[(0,i.Wm)("div",fe,[(0,i.Wm)(Ie,{"model-value":n.selectedProjector.blendingGuideLineB,"onUpdate:modelValue":n.setBlendingGuideLineB,min:0,max:100},null,8,["model-value","onUpdate:modelValue"])]),(0,i.Wm)("div",Re,[(0,i.Wm)(l,{flat:"",color:"primary",onClick:t[14]||(t[14]=()=>{n.setBlendingGuideLineB(0)}),icon:"refresh"})])]),(0,i.Wm)("div",we,(0,d.zw)(`${n.blendingBottomPixel} ${e.$t("pixel")}`)+": ",1)])),_:1},8,["disable","model-value","onUpdate:modelValue","color"])])])),_:1}),(0,i.Wm)(Ve,{name:"layout"},{default:m((()=>[0===r.selectedRows.length?((0,i.wg)(),(0,i.j4)("div",Te,(0,d.zw)(e.$t("selectProjectors")),1)):((0,i.wg)(),(0,i.j4)("div",ye,(0,d.zw)(e.$t("currentBase"))+" :"+(0,d.zw)(n.selectedProjector.customName),1)),(0,i.wy)((0,i.Wm)("div",xe,[(0,i.Wm)(l,{push:"",color:"primary",label:e.$t("xAlign"),onClick:n.xAlign},null,8,["label","onClick"]),(0,i.Wm)(l,{push:"",color:"primary",label:e.$t("yAlign"),onClick:n.yAlign},null,8,["label","onClick"]),(0,i.Wm)(l,{push:"",color:"primary",label:e.$t("zAlign"),onClick:n.zAlign},null,8,["label","onClick"]),(0,i.Wm)(l,{push:"",color:"primary",label:e.$t("row"),onClick:n.row},null,8,["label","onClick"]),(0,i.Wm)(l,{push:"",color:"primary",label:e.$t("column"),onClick:n.column},null,8,["label","onClick"]),(0,i.Wm)(Me,{modelValue:r.gridX,"onUpdate:modelValue":t[15]||(t[15]=e=>r.gridX=e),color:e.$q.dark.isActive?"primary":"positive",type:"number",min:"1",max:"10",style:{"min-width":"200px"}},{prepend:m((()=>[Le])),append:m((()=>[(0,i.Wm)(l,{push:"",color:"primary",label:e.$t("grid"),onClick:n.grid},null,8,["label","onClick"])])),_:1},8,["modelValue","color"])],512),[[h.F8,r.selectedRows.length>0]])])),_:1})])),_:1},8,["modelValue"])])),_:1})]),(0,i.Wm)("div",Ce,[(0,i.Wm)("div",Oe,[(0,i.Wm)(qe,{onRowClick:n.clickRow,selected:r.selectedRows,"onUpdate:selected":t[17]||(t[17]=e=>r.selectedRows=e),rows:n.projectors,columns:n.columns,"row-key":"uId",class:"my-sticky-header-table",selection:"multiple",pagination:{rowsPerPage:100},"hide-bottom":"",dense:"",flat:"",bordered:"",square:""},{"body-cell":m((e=>[(0,i.Wm)(Ue,{props:e},{default:m((()=>[e.row.uId===n.selectedProjector.uId?((0,i.wg)(),(0,i.j4)("span",ze,(0,d.zw)(e.value),1)):((0,i.wg)(),(0,i.j4)("span",Be,(0,d.zw)(e.value),1))])),_:2},1032,["props"])])),_:1},8,["onRowClick","selected","rows","columns"])])])])])),_:1})):(0,i.kq)("",!0)],512)),[[h.F8,n.showProjectorDetail]])}));var De=o(11185),Ie=o(63898);const Me={name:"Projector-Detail",data(){return{tab:"position",gridX:3,selectedRows:[],aspectRatios:[{label:"16:9",value:16/9},{label:"16:10",value:1.6},{label:"4:3",value:4/3}]}},computed:{unitRatio(){return this.$store.state.common.unitRatio},unitLabel(){return this.$store.state.common.unitLabel},columns(){return[{name:"customName",required:!0,label:"customName",field:"customName",align:"left"},{name:"modelName",required:!0,label:"modelName",field:"modelName",align:"left"},{name:"lensName",required:!0,label:"lensName",field:"lensName",align:"left",format:e=>`${e||"fixed"}`},{name:"x",required:!0,label:`x(${this.unitLabel})`,field:"x",align:"left",format:e=>Number(e).toFixed(2)},{name:"y",required:!0,label:`y(${this.unitLabel})`,field:"y",align:"left",format:e=>Number(e).toFixed(2)},{name:"z",required:!0,label:`z(${this.unitLabel})`,field:"z",align:"left",format:e=>Number(e).toFixed(2)},{name:"rotateX",required:!0,label:"rotateX(°)",field:"rotateX",align:"left"},{name:"rotateY",required:!0,label:"rotateY(°)",field:"rotateY",align:"left"},{name:"rotateZ",required:!0,label:"rotateZ(°)",field:"rotateZ",align:"left"},{name:"throwRatio",required:!0,label:"throwRatio",field:"throwRatio",align:"left"},{name:"lensShiftH",required:!0,label:"lensShiftH(%)",field:"lensShiftH",align:"left"},{name:"lensShiftV",required:!0,label:"lensShiftV(%)",field:"lensShiftV",align:"left"}]},projectors(){return this.$store.state.projector.projectors},showProjectorDetail:{get(){return this.$store.state.common.showProjectorDetail},set(e){this.SET_SHOW_PROJECTOR_DETAIL(e)}},selectedProjector(){return this.$store.getters["projector/selectedProjector"]},blendingLeftPixel(){return this.selectedProjector?(this.selectedProjector.resolutionX/2*(this.selectedProjector.blendingGuideLineL/100)).toFixed(0):0},blendingRightPixel(){return this.selectedProjector?(this.selectedProjector.resolutionX/2*(this.selectedProjector.blendingGuideLineR/100)).toFixed(0):0},blendingTopPixel(){return this.selectedProjector?(this.selectedProjector.resolutionX/2*(this.selectedProjector.blendingGuideLineT/100)).toFixed(0):0},blendingBottomPixel(){return this.selectedProjector?(this.selectedProjector.resolutionX/2*(this.selectedProjector.blendingGuideLineB/100)).toFixed(0):0}},methods:a()(a()(a()({},(0,c.OI)("common",["SET_SHOW_PROJECTOR_DETAIL"])),(0,c.OI)("projector",["SET_SELECTED_PROJECTOR_X","SET_PROJECTORS_X","SET_SELECTED_PROJECTOR_Y","SET_PROJECTORS_Y","SET_SELECTED_PROJECTOR_Z","SET_PROJECTORS_Z","SET_SELECTED_PROJECTOR_ROTATE_X","SET_SELECTED_PROJECTOR_ROTATE_Y","SET_SELECTED_PROJECTOR_ROTATE_Z","SET_SELECTED_PROJECTOR_LENS_SHIFT_H","SET_SELECTED_PROJECTOR_LENS_SHIFT_V","SET_SELECTED_PROJECTOR_THROW_RATIO","SET_SELECTED_PROJECTOR_UID","ADD_PROJECTOR","SET_SELECTED_PROJECTOR_IMAGE_ASPECT_RATIO","SET_SELECTED_PROJECTOR_SHOW_BLENDING_GUIDE_LINE","SET_SELECTED_PROJECTOR_BLENDING_GUIDE_LINE_L","SET_SELECTED_PROJECTOR_BLENDING_GUIDE_LINE_R","SET_SELECTED_PROJECTOR_BLENDING_GUIDE_LINE_T","SET_SELECTED_PROJECTOR_BLENDING_GUIDE_LINE_B"])),{},{selectSelfRow(){-1===this.selectedRows.findIndex((e=>e.uId===this.selectedProjector.uId))&&this.selectedRows.push(this.selectedProjector)},copyProjector(){const e=new Ie.u;Object.keys(this.selectedProjector).forEach((t=>{e[t]=this.selectedProjector[t]})),e.uId=(0,De.Z)(),e.customName=`${e.customName}(copy-${e.uId.slice(0,4)})`,this.ADD_PROJECTOR(e),this.SET_SELECTED_PROJECTOR_UID(e.uId),this.$bus.emit("addProjector",e.uId)},setX(e){this.SET_SELECTED_PROJECTOR_X(+e),this.setProjector()},setY(e){this.SET_SELECTED_PROJECTOR_Y(+e),this.setProjector()},setZ(e){this.SET_SELECTED_PROJECTOR_Z(+e),this.setProjector()},setRotateX(e){this.SET_SELECTED_PROJECTOR_ROTATE_X(+e),this.setProjector()},setRotateY(e){this.SET_SELECTED_PROJECTOR_ROTATE_Y(+e),this.setProjector()},setRotateZ(e){this.SET_SELECTED_PROJECTOR_ROTATE_Z(+e),this.setProjector()},setLensShiftH(e){this.SET_SELECTED_PROJECTOR_LENS_SHIFT_H(+e),this.setProjector()},setLensShiftV(e){this.SET_SELECTED_PROJECTOR_LENS_SHIFT_V(+e),this.setProjector()},setThrowRatio(e){this.SET_SELECTED_PROJECTOR_THROW_RATIO(+e),this.setProjector()},changeImageAspectRatio(e){this.SET_SELECTED_PROJECTOR_IMAGE_ASPECT_RATIO(+e),this.setProjector()},setShowBlendingGuideLine(e){this.SET_SELECTED_PROJECTOR_SHOW_BLENDING_GUIDE_LINE(e),this.setProjector()},setBlendingGuideLineL(e){this.SET_SELECTED_PROJECTOR_BLENDING_GUIDE_LINE_L(+e),this.setProjector()},setBlendingGuideLineR(e){this.SET_SELECTED_PROJECTOR_BLENDING_GUIDE_LINE_R(+e),this.setProjector()},setBlendingGuideLineT(e){this.SET_SELECTED_PROJECTOR_BLENDING_GUIDE_LINE_T(+e),this.setProjector()},setBlendingGuideLineB(e){this.SET_SELECTED_PROJECTOR_BLENDING_GUIDE_LINE_B(+e),this.setProjector()},xAlign(){this.SET_PROJECTORS_X({projectors:this.selectedRows,value:this.selectedProjector.x}),this.setProjectors(this.selectedRows)},yAlign(){this.SET_PROJECTORS_Y({projectors:this.selectedRows,value:this.selectedProjector.y}),this.setProjectors(this.selectedRows)},zAlign(){this.SET_PROJECTORS_Z({projectors:this.selectedRows,value:this.selectedProjector.z}),this.setProjectors(this.selectedRows)},row(){this.SET_PROJECTORS_Y({projectors:this.selectedRows,value:this.selectedProjector.y}),this.SET_PROJECTORS_Z({projectors:this.selectedRows,value:this.selectedProjector.z});const e=this.selectedProjector.projectionDistance/this.selectedProjector.throwRatio;let t=1;this.selectedRows.forEach((o=>{o.uId!==this.selectedProjector.uId&&(t%2===0?this.SET_PROJECTORS_X({projectors:[o],value:this.selectedProjector.x-e*Math.ceil(t/2)}):this.SET_PROJECTORS_X({projectors:[o],value:this.selectedProjector.x+e*Math.ceil(t/2)}),t++)})),this.setProjectors(this.selectedRows)},column(){this.SET_PROJECTORS_X({projectors:this.selectedRows,value:this.selectedProjector.x}),this.SET_PROJECTORS_Z({projectors:this.selectedRows,value:this.selectedProjector.z});const e=this.selectedProjector.projectionDistance/this.selectedProjector.throwRatio,t=e/this.selectedProjector.aspectRatio;let o=1;this.selectedRows.forEach((e=>{e.uId!==this.selectedProjector.uId&&(o%2===0?this.SET_PROJECTORS_Y({projectors:[e],value:this.selectedProjector.y-t*Math.ceil(o/2)}):this.SET_PROJECTORS_Y({projectors:[e],value:this.selectedProjector.y+t*Math.ceil(o/2)}),o++)})),this.setProjectors(this.selectedRows)},grid(){this.SET_PROJECTORS_Z({projectors:this.selectedRows,value:this.selectedProjector.z});const e=this.selectedProjector.projectionDistance/this.selectedProjector.throwRatio,t=e/this.selectedProjector.aspectRatio;let o=0,i=1;this.selectedRows.forEach((s=>{s.uId!==this.selectedProjector.uId&&(this.SET_PROJECTORS_X({projectors:[s],value:this.selectedProjector.x-e*i}),this.SET_PROJECTORS_Y({projectors:[s],value:this.selectedProjector.y-t*o}),i++,i>=this.gridX&&(i=0,o++))})),this.setProjectors(this.selectedRows)},setProjector(){this.$bus.emit("setProjector",this.selectedProjector)},setProjectors(e){this.$bus.emit("setProjectors",e)},clickRow(e,t,o){this.SET_SELECTED_PROJECTOR_UID(t.uId),this.$bus.emit("setProjector",t)}})};var Ve=o(10151),$e=o(25589),Ae=o(48240),Ge=o(57547),Ue=o(3269),qe=o(65869),ke=o(5906),Je=o(86602),Ne=o(34842),He=o(62064),Ze=o(31436),Xe=o(11420),Ye=o(36429),Fe=o(83884),Qe=o(7518),Ke=o.n(Qe);Me.render=We,Me.__scopeId="data-v-0eb4e03f";const et=Me;Ke()(Me,"components",{QCard:Ve.Z,QCardSection:$e.Z,QBtn:Ae.Z,QTabs:Ge.Z,QTab:Ue.Z,QSeparator:qe.Z,QTabPanels:ke.Z,QTabPanel:Je.Z,QInput:Ne.Z,QSlider:He.Z,QSelect:Ze.Z,QCheckbox:Xe.Z,QTable:Ye.Z,QTd:Fe.Z});var tt=o(44241),ot=(o(10071),o(60979),o(1118),o(12396),o(75691)),it=o(52483),st=o(57742),rt=o(45810),nt=o(13991),lt=o(35389),at=o(29058),ct=o(52934);class dt{constructor(){this._renderer=null,this._dom=null,this._camera=null,this._scene=null,this._light=null,this._raycaster=new nt.iMs,this._mouse=new nt.FM8,this._hotProjectorUid="",this._projectors=[],this._textures={},this._texture={wall:null,floor:null},this._room={material:{front:null,back:null,left:null,right:null,top:null,bottom:null},geometrys:{front:null,back:null,left:null,right:null,top:null,bottom:null},objects:{front:null,back:null,left:null,right:null,top:null,bottom:null}},this._roomSize={width:0,height:0,depth:0,widthDraw:0,heightDraw:0,depthDraw:0,ratio:10},this._screenType=ct.jT.plane,this._screen={material:null,geometry:null,object:null},this._planeScreen={diagonal:0,aspectRatio:0},this._curvedScreen={diagonal:0,aspectRatio:0,radius:0,radialSegments:3,isSmooth:!0},this._sphereScreen={radius:0,phiStart:0,phiLength:100},this._customScreen={geometry:"",material:""},this._controls=null}_initRenderer(e){this._renderer=new nt.CP7,this._dom=document.querySelector(e),this._dom.appendChild(this._renderer.domElement);const t=this._dom.getBoundingClientRect();this._renderer.setSize(t.width,t.height+20),this._initCamera(t),this._dom.addEventListener("mousemove",(e=>{this._onMouseMove(e)}),!1),this._dom.addEventListener("mousedown",(()=>{this._onMouseDown()}),!1)}onWindowResize(){const e=this._dom.getBoundingClientRect();this._camera.aspect=e.width/e.height,this._camera.updateProjectionMatrix(),this._renderer.setSize(e.width,e.height)}_onMouseMove(e){const t=this._dom.getBoundingClientRect();this._mouse.x=e.offsetX/t.width*2-1,this._mouse.y=-e.offsetY/t.height*2+1}_onMouseDown(){this._hotProjectorUid&&(tt.default.commit("projector/SET_SELECTED_PROJECTOR_UID",this._hotProjectorUid),this._setTransformControl(this._hotProjectorUid),this._createAllBoundLine())}_setTransformControl(e){const t=this._projectors.find((t=>t.name===e));this._transformControl.object!==t&&this._transformControl.attach(t)}_initCamera(e){this._camera=new nt.cPb(40,e.width/e.height,.1,1e3),this._camera.position.set(24,50,-200),this._camera.lookAt(0,0,0)}_initScene(){this._scene=new nt.xsS,this._initLight(),this.setTheme()}_initLight(){this._roomSize.depth=tt.default.state.room.depth,this._roomSize.depthDraw=this._roomSize.depth*this._roomSize.ratio,this._light?this._light.position.set(0,0,this._roomSize.depthDraw/2):(this._light=new nt.cek(16777215,1.2,0,2),this._light.position.set(0,0,this._roomSize.depthDraw/2),this._scene.add(this._light))}_initControls(){this._controls=new ot.z(this._camera,this._renderer.domElement),this._controls.addEventListener("change",(()=>{}))}_initTransformControl(){this._transformControl=new it.Ys(this._camera,this._renderer.domElement),this._transformControl.size=.5,this._transformControl.addEventListener("dragging-changed",(e=>{this._controls.enabled=!e.value}));let e=0;this._transformControl.addEventListener("change",(t=>{e++,e%2===0&&this._transformControl.object&&(tt.default.commit("projector/SET_SELECTED_PROJECTOR_X",this._transformControl.object.position.x/this._roomSize.ratio),tt.default.commit("projector/SET_SELECTED_PROJECTOR_Y",this._transformControl.object.position.y/this._roomSize.ratio),tt.default.commit("projector/SET_SELECTED_PROJECTOR_Z",this._transformControl.object.position.z/this._roomSize.ratio),this._createBoundLine(this._transformControl.object.name))})),this._scene.add(this._transformControl)}_render(){this._raycaster.setFromCamera(this._mouse,this._camera),this._hotProjectorUid=null,this._projectors.forEach((e=>{const t=this._raycaster.intersectObjects(e.children);t.length>0?e.children.forEach((t=>{t.material.emissive.setHex(255),this._hotProjectorUid=e.name})):e.children.forEach((e=>{e.material.emissive.setHex(0)}))})),this._renderer.render(this._scene,this._camera)}setTheme(){this._scene.background=at.Z.isActive?new nt.Ilk(1250327):new nt.Ilk(16776427)}animate(){requestAnimationFrame((()=>{this.animate()})),this._render()}_initTexture(){const e=new nt.dpR,t=new Promise(((t,o)=>{e.load("texture/wall.jfif",(e=>{const o=new nt.YBo({map:e,side:nt.Wl3,emissive:16711422,emissiveIntensity:.2});this._room.material.front=o,this._room.material.back=o,this._room.material.left=o,this._room.material.right=o,this._room.material.top=o,t(e)}),null,(e=>{o(e)}))})),o=new Promise(((t,o)=>{e.load("texture/floor.jfif",(e=>{const o=new nt.YBo({map:e,side:nt.Wl3,emissive:16711422,emissiveIntensity:.2});this._room.material.bottom=o,t(e)}),null,(e=>{o(e)}))})),i=new Promise(((t,o)=>{e.load("texture/screen2.jpg",(e=>{const o=new nt.vBJ({map:e,side:nt.ehD,transparent:!0,opacity:.8});this._screen.material=o,t(e)}),null,(e=>{o(e)}))}));return Promise.all([t,o,i])}_loadTexture(e,t){const o=new nt.dpR;return new Promise(((i,s)=>{if(t){const t=document.createElement("video");t.src=e,t.style.width="0px",t.autoplay=!0,t.muted=!0,t.loop=!0,t.controls=!0;const o=document.getElementById("textureVideo");o.appendChild(t);const s=new nt.fO1(t);i(s)}else o.load(e,(e=>{i(e)}),null,(e=>{s(e)}))}))}_initRoom(){this._roomSize.width=tt.default.state.room.width,this._roomSize.height=tt.default.state.room.height,this._roomSize.depth=tt.default.state.room.depth,this._roomSize.widthDraw=this._roomSize.width*this._roomSize.ratio,this._roomSize.heightDraw=this._roomSize.height*this._roomSize.ratio,this._roomSize.depthDraw=this._roomSize.depth*this._roomSize.ratio,this._room&&(Object.values(this._room.geometrys).forEach((e=>{e&&e.dispose()})),Object.values(this._room.objects).forEach((e=>{e&&this._scene.remove(e)}))),this._room.geometrys.front=new nt._12(this._roomSize.widthDraw,this._roomSize.heightDraw),this._room.objects.front=new nt.Kj0(this._room.geometrys.front,this._room.material.front),this._room.objects.front.position.z=this._roomSize.depthDraw,this._room.objects.front.rotateY(1*Math.PI),this._scene.add(this._room.objects.front),this._room.geometrys.back=new nt._12(this._roomSize.widthDraw,this._roomSize.heightDraw),this._room.objects.back=new nt.Kj0(this._room.geometrys.back,this._room.material.back),this._scene.add(this._room.objects.back),this._room.geometrys.top=new nt._12(this._roomSize.widthDraw,this._roomSize.depthDraw),this._room.objects.top=new nt.Kj0(this._room.geometrys.top,this._room.material.top),this._room.objects.top.position.z=this._roomSize.depthDraw/2,this._room.objects.top.position.y=this._roomSize.heightDraw/2,this._room.objects.top.rotateX(.5*Math.PI),this._scene.add(this._room.objects.top),this._room.geometrys.bottom=new nt._12(this._roomSize.widthDraw,this._roomSize.depthDraw),this._room.objects.bottom=new nt.Kj0(this._room.geometrys.bottom,this._room.material.bottom),this._room.objects.bottom.position.z=this._roomSize.depthDraw/2,this._room.objects.bottom.position.y=-this._roomSize.heightDraw/2,this._room.objects.bottom.rotateX(-.5*Math.PI),this._scene.add(this._room.objects.bottom),this._room.geometrys.left=new nt._12(this._roomSize.depthDraw,this._roomSize.heightDraw),this._room.objects.left=new nt.Kj0(this._room.geometrys.left,this._room.material.left),this._room.objects.left.position.z=this._roomSize.depthDraw/2,this._room.objects.left.position.x=this._roomSize.widthDraw/2,this._room.objects.left.rotateY(-.5*Math.PI),this._scene.add(this._room.objects.left),this._room.geometrys.right=new nt._12(this._roomSize.depthDraw,this._roomSize.heightDraw),this._room.objects.right=new nt.Kj0(this._room.geometrys.right,this._room.material.right),this._room.objects.right.position.z=this._roomSize.depthDraw/2,this._room.objects.right.position.x=-this._roomSize.widthDraw/2,this._room.objects.right.rotateY(.5*Math.PI),this._scene.add(this._room.objects.right)}_initScreen(){this._screen.geometry&&this._screen.geometry.dispose(),this._screen.object&&this._scene.remove(this._screen.object),this._screenType===ct.jT.plane&&this._createPlaneScreen(),this._screenType===ct.jT.curved&&this._createCurveScreen(),this._screenType===ct.jT.sphere&&this._createSphereScreen(),this._screenType===ct.jT.custom&&this._createCustomScreen(),this.adjustScreenPosition()}adjustScreenPosition(){const e=this._screen.geometry.attributes.position.array,t=this._screen.geometry.attributes.position.count;let o=0,i=0,s=0,r=0,n=0;for(let l=0;l<t;l++){const[t,a,c]=[e[3*l],e[3*l+1],e[3*l+2]];t<o&&(o=t),t>i&&(i=t),a<s&&(s=a),a>r&&(r=a),c>n&&(n=c)}this._screen.object.position.x=this._roomSize.widthDraw/2-i-(o- -this._roomSize.widthDraw/2),this._screen.object.position.y=this._roomSize.heightDraw/2-r-(s- -this._roomSize.heightDraw/2),this._screen.object.position.z=this._roomSize.depthDraw-n-.5*this._roomSize.ratio,this._screen.object.position.x=0,this._screen.object.position.y=0,this._screen.object.position.z=this._roomSize.depthDraw-n-1*this._roomSize.ratio,tt.default.commit("screen/SET_X",this._screen.object.position.x/this._roomSize.ratio),tt.default.commit("screen/SET_Y",this._screen.object.position.y/this._roomSize.ratio),tt.default.commit("screen/SET_Z",this._screen.object.position.z/this._roomSize.ratio),tt.default.commit("screen/SET_ROTATE_X",this._screen.object.rotation.x/Math.PI*180),tt.default.commit("screen/SET_ROTATE_Y",this._screen.object.rotation.y/Math.PI*180),tt.default.commit("screen/SET_ROTATE_Z",this._screen.object.rotation.z/Math.PI*180),this._screen.object.updateMatrixWorld(),this._createAllBoundLine()}_createPlaneScreen(){this._planeScreen.diagonal=tt.default.state.screen.plane.diagonal,this._planeScreen.aspectRatio=tt.default.state.screen.plane.aspectRatio,0===this._planeScreen.aspectRatio&&(this._planeScreen.aspectRatio=tt.default.state.screen.plane.width/tt.default.state.screen.plane.height);const e=this._planeScreen.diagonal/ct.OO.inch,t=Math.atan(this._planeScreen.aspectRatio),o=e*Math.sin(t),i=o/this._planeScreen.aspectRatio;this._screen.geometry=new nt._12(o*this._roomSize.ratio,i*this._roomSize.ratio),this._screen.object=new nt.Kj0(this._screen.geometry,this._screen.material),this._scene.add(this._screen.object)}_createCurveScreen(){this._curvedScreen.diagonal=tt.default.state.screen.curved.diagonal,this._curvedScreen.aspectRatio=tt.default.state.screen.curved.aspectRatio,this._curvedScreen.radius=tt.default.state.screen.curved.radius*this._roomSize.ratio,this._curvedScreen.radialSegments=tt.default.state.screen.curved.radialSegments,this._curvedScreen.isSmooth=tt.default.state.screen.curved.isSmooth,0===this._curvedScreen.aspectRatio&&(this._curvedScreen.aspectRatio=tt.default.state.screen.curved.width/tt.default.state.screen.curved.height);const e=this._curvedScreen.diagonal/ct.OO.inch,t=Math.atan(this._curvedScreen.aspectRatio),o=e*Math.sin(t),i=o/this._curvedScreen.aspectRatio,s=o*this._roomSize.ratio/this._curvedScreen.radius;this._screen.geometry=new nt.fHI(this._curvedScreen.radius,this._curvedScreen.radius,i*this._roomSize.ratio,this._curvedScreen.isSmooth?128:this._curvedScreen.radialSegments,1,!0,-s/2,s),this._screen.object=new nt.Kj0(this._screen.geometry,this._screen.material),this._scene.add(this._screen.object)}_createSphereScreen(){this._sphereScreen.radius=tt.default.state.screen.sphere.radius*this._roomSize.ratio,this._sphereScreen.phiStart=tt.default.state.screen.sphere.phiStart/180*Math.PI,this._sphereScreen.phiLength=tt.default.state.screen.sphere.phiLength/180*Math.PI,this._sphereScreen.thetaStart=tt.default.state.screen.sphere.thetaStart/180*Math.PI,this._sphereScreen.thetaLength=(1-tt.default.state.screen.sphere.thetaEnd/180-tt.default.state.screen.sphere.thetaStart/180)*Math.PI,this._screen.geometry=new nt.xo$(this._sphereScreen.radius,16,16,this._sphereScreen.phiStart,this._sphereScreen.phiLength,this._sphereScreen.thetaStart,this._sphereScreen.thetaLength),this._screen.object=new nt.Kj0(this._screen.geometry,this._screen.material),this._scene.add(this._screen.object)}_createCustomScreen(){const e=tt.default.state.screen.custom.geometrySrc,t=tt.default.state.screen.custom.materialSrc;if(""===e)return void(this._screen.object=new nt.Kj0);const o=new rt.v,i=new st.L;o.loadAsync(t).then((t=>{i.setMaterials(t),i.loadAsync(e).then((e=>{e.children.forEach((e=>{e.geometry.computeBoundingBox(),e.geometry.center()})),e.isScreen=!0,this._screen.object=e,this._scene.add(e),this.adjustScreenPosition()}))}))}_addProjecotr(e){const t=new rt.v,o=new st.L,i=new Promise(((i,s)=>{t.load("models/H7T_Laset7.mtl",(t=>{o.setMaterials(t),o.load("models/H7T_Laset7.obj",(t=>{t.children.forEach((e=>{e.geometry.computeBoundingBox(),e.geometry.center()})),t.name=e,t.position.z=this._roomSize.depthDraw/2,this._scene.add(t),this._transformControl.attach(t),i(t)}),void 0,(e=>{s(e)}))}),void 0,(e=>{s(e)}))}));return i}_disposeBoundLine(e){var t,o,i,s,r,n,l,a,c,d,h,m,u,_,p,j,S,v,P,b,g,E,f,R,w,T,y,x,L,C,O,z,B,W,D,I,M,V,$,A,G,U,q,k,J,N,H,Z,X,Y,F,Q,K,ee,te,oe;const ie=this._projectors.find((t=>t.name===e));(null===(t=ie.lightBoundLT)||void 0===t?void 0:t.geometry)&&(null===(o=ie.lightBoundLT)||void 0===o||o.geometry.dispose()),(null===(i=ie.lightBoundLT)||void 0===i?void 0:i.object)&&this._scene.remove(null===(s=ie.lightBoundLT)||void 0===s?void 0:s.object),(null===(r=ie.lightBoundRT)||void 0===r?void 0:r.geometry)&&(null===(n=ie.lightBoundRT)||void 0===n||n.geometry.dispose()),(null===(l=ie.lightBoundRT)||void 0===l?void 0:l.object)&&this._scene.remove(null===(a=ie.lightBoundRT)||void 0===a?void 0:a.object),(null===(c=ie.lightBoundLB)||void 0===c?void 0:c.geometry)&&(null===(d=ie.lightBoundLB)||void 0===d||d.geometry.dispose()),(null===(h=ie.lightBoundLB)||void 0===h?void 0:h.object)&&this._scene.remove(null===(m=ie.lightBoundLB)||void 0===m?void 0:m.object),(null===(u=ie.lightBoundRB)||void 0===u?void 0:u.geometry)&&(null===(_=ie.lightBoundRB)||void 0===_||_.geometry.dispose()),(null===(p=ie.lightBoundRB)||void 0===p?void 0:p.object)&&this._scene.remove(null===(j=ie.lightBoundRB)||void 0===j?void 0:j.object),(null===(S=ie.lightBoundC)||void 0===S?void 0:S.geometry)&&(null===(v=ie.lightBoundC)||void 0===v||v.geometry.dispose()),(null===(P=ie.lightBoundC)||void 0===P?void 0:P.object)&&this._scene.remove(null===(b=ie.lightBoundC)||void 0===b?void 0:b.object),(null===(g=ie.screenBoundL)||void 0===g?void 0:g.geometry)&&(null===(E=ie.screenBoundL)||void 0===E||E.geometry.dispose()),(null===(f=ie.screenBoundL)||void 0===f?void 0:f.object)&&this._scene.remove(null===(R=ie.screenBoundL)||void 0===R?void 0:R.object),(null===(w=ie.screenBoundR)||void 0===w?void 0:w.geometry)&&(null===(T=ie.screenBoundR)||void 0===T||T.geometry.dispose()),(null===(y=ie.screenBoundR)||void 0===y?void 0:y.object)&&this._scene.remove(null===(x=ie.screenBoundR)||void 0===x?void 0:x.object),(null===(L=ie.screenBoundT)||void 0===L?void 0:L.geometry)&&(null===(C=ie.screenBoundT)||void 0===C||C.geometry.dispose()),(null===(O=ie.screenBoundT)||void 0===O?void 0:O.object)&&this._scene.remove(null===(z=ie.screenBoundT)||void 0===z?void 0:z.object),(null===(B=ie.screenBoundB)||void 0===B?void 0:B.geometry)&&(null===(W=ie.screenBoundB)||void 0===W||W.geometry.dispose()),(null===(D=ie.screenBoundB)||void 0===D?void 0:D.object)&&this._scene.remove(null===(I=ie.screenBoundB)||void 0===I?void 0:I.object),(null===(M=ie.blendingGuideLineL)||void 0===M?void 0:M.geometry)&&(null===(V=ie.blendingGuideLineL)||void 0===V||V.geometry.dispose()),(null===($=ie.blendingGuideLineL)||void 0===$?void 0:$.object)&&this._scene.remove(null===(A=ie.blendingGuideLineL)||void 0===A?void 0:A.object),(null===(G=ie.blendingGuideLineR)||void 0===G?void 0:G.geometry)&&(null===(U=ie.blendingGuideLineR)||void 0===U||U.geometry.dispose()),(null===(q=ie.blendingGuideLineR)||void 0===q?void 0:q.object)&&this._scene.remove(null===(k=ie.blendingGuideLineR)||void 0===k?void 0:k.object),(null===(J=ie.blendingGuideLineT)||void 0===J?void 0:J.geometry)&&(null===(N=ie.blendingGuideLineT)||void 0===N||N.geometry.dispose()),(null===(H=ie.blendingGuideLineT)||void 0===H?void 0:H.object)&&this._scene.remove(null===(Z=ie.blendingGuideLineT)||void 0===Z?void 0:Z.object),(null===(X=ie.blendingGuideLineB)||void 0===X?void 0:X.geometry)&&(null===(Y=ie.blendingGuideLineB)||void 0===Y||Y.geometry.dispose()),(null===(F=ie.blendingGuideLineB)||void 0===F?void 0:F.object)&&this._scene.remove(null===(Q=ie.blendingGuideLineB)||void 0===Q?void 0:Q.object),(null===(K=ie.screenPlane)||void 0===K?void 0:K.geometry)&&(null===(ee=ie.screenPlane)||void 0===ee||ee.geometry.dispose()),(null===(te=ie.screenPlane)||void 0===te?void 0:te.object)&&this._scene.remove(null===(oe=ie.screenPlane)||void 0===oe?void 0:oe.object)}_createBoundLine(e){const t=this._projectors.find((t=>t.name===e)),o=tt.default.state.projector.projectors.find((t=>t.uId===e)),i=tt.default.state.projector.selectedProjectorUid===e;if(!t||!o)return;this._disposeBoundLine(e);const s=1/o.throwRatio/o.aspectRatio/2,r=1+(2*o.lensShiftV+o.offset)/100,n=180*Math.atan(s*r)/Math.PI,l=1-(2*o.lensShiftV+o.offset)/100,a=180*Math.atan(s*l)/Math.PI,c=1/o.throwRatio/2,d=1+2*o.lensShiftH/100,h=180*Math.atan(c*d)/Math.PI,m=1-2*o.lensShiftH/100,u=180*Math.atan(c*m)/Math.PI,_=(n-a)/2,p=(u-h)/2,j=new nt.Pa4;j.set(Math.tan(u*Math.PI/180),Math.tan(n*Math.PI/180),1);const S=j.clone();this._applayDirectionRotation(j,t);const v=new nt.Pa4;v.set(-Math.tan(h*Math.PI/180),Math.tan(n*Math.PI/180),1);const P=v.clone();this._applayDirectionRotation(v,t);const b=new nt.Pa4;b.set(Math.tan(u*Math.PI/180),-Math.tan(a*Math.PI/180),1);const g=b.clone();this._applayDirectionRotation(b,t);const E=new nt.Pa4;E.set(-Math.tan(h*Math.PI/180),-Math.tan(a*Math.PI/180),1);const f=E.clone();this._applayDirectionRotation(E,t);const R=new nt.Pa4;if(R.set(Math.tan(p*Math.PI/180),Math.tan(_*Math.PI/180),1),this._applayDirectionRotation(R,t),t.lightBoundLT=this._createRayLine(t.position,j,i),t.lightBoundRT=this._createRayLine(t.position,v,i),t.lightBoundLB=this._createRayLine(t.position,b,i),t.lightBoundRB=this._createRayLine(t.position,E,i),tt.default.commit("projector/SET_SELECTED_PROJECTOR_PROJECTION_DISTANCE",this._calcHitDistance(t.position,R)/this._roomSize.ratio),t.screenBoundL=this._createScreenBoundLine(t.position,S,g,"y",t,i),t.screenBoundR=this._createScreenBoundLine(t.position,P,f,"y",t,i),t.screenBoundT=this._createScreenBoundLine(t.position,S,P,"x",t,i),t.screenBoundB=this._createScreenBoundLine(t.position,g,f,"x",t,i),o.isShowBlendingGuideLine){const e=S.clone(),s=P.clone(),r=g.clone(),n=f.clone(),l=(s.x-e.x)*o.blendingGuideLineL/100/2,a=(s.x-e.x)*o.blendingGuideLineR/100/2,c=(r.y-e.y)*o.blendingGuideLineT/100/2,d=(r.y-e.y)*o.blendingGuideLineB/100/2;e.x+=l,e.y+=c,s.x-=a,s.y+=c,r.x+=l,r.y-=d,n.x-=a,n.y-=d,t.blendingGuideLineL=this._createBlendingGuideLine(t.position,e,r,"y",t,i),t.blendingGuideLineR=this._createBlendingGuideLine(t.position,s,n,"y",t,i),t.blendingGuideLineT=this._createBlendingGuideLine(t.position,e,s,"x",t,i),t.blendingGuideLineB=this._createBlendingGuideLine(t.position,r,n,"x",t,i)}t.screenPlane=this._createScreenPlane(t.position,S,g,f,t,o)}_applayDirectionRotation(e,t){const o=new nt.Pa4(1,0,0),i=new nt.Pa4(0,1,0),s=new nt.Pa4(0,0,1);e.applyAxisAngle(o,t.rotation.x),e.applyAxisAngle(i,t.rotation.y),e.applyAxisAngle(s,t.rotation.z)}_createScreenBoundLine(e,t,o,i,s,r){const n=this._calcDivideCutPoints(e,t,o,i,s),l={geometry:null,object:null};l.geometry=new lt.VJ,l.geometry.setPoints(n);const a=new lt.r7({color:15689814,lineWidth:.4,transparent:!r,opacity:.6});return l.object=new nt.Kj0(l.geometry,a),this._scene.add(l.object),l}_createBlendingGuideLine(e,t,o,i,s,r){const n=this._calcDivideCutPoints(e,t,o,i,s),l={geometry:null,object:null};l.geometry=new lt.VJ,l.geometry.setPoints(n);const a=new lt.r7({color:255,lineWidth:.4,transparent:!r,opacity:.6});return l.object=new nt.Kj0(l.geometry,a),this._scene.add(l.object),l}_createScreenPlane(e,t,o,i,s,r){if(r.imageAspectRatio>r.aspectRatio){const e=(r.imageAspectRatio-r.aspectRatio)/r.imageAspectRatio*(t.y-o.y);t.y-=e/2,o.y+=e/2}else if(r.imageAspectRatio<r.aspectRatio){const e=(r.aspectRatio-r.imageAspectRatio)/r.aspectRatio*(o.x-i.x);o.x-=e/2,i.x+=e/2}const n=30,l=[],a=[],c=[],d=[],h=(t.y-o.y)/n;for(let S=0;S<=n;S++){const t=o.clone();t.y+=h*S;const r=i.clone();r.y+=h*S,d[S]=this._calcDivideCutPoints(e,t,r,"x",s)}for(let S=0;S<d.length;S++)for(let e=0;e<d[S].length;e++)if(d[S+1]&&d[S][e+1]){l.push(d[S][e].x),l.push(d[S][e].y),l.push(d[S][e].z),l.push(d[S+1][e].x),l.push(d[S+1][e].y),l.push(d[S+1][e].z),l.push(d[S+1][e+1].x),l.push(d[S+1][e+1].y),l.push(d[S+1][e+1].z),c.push(e/n),c.push(S/n),c.push(e/n),c.push((S+1)/n),c.push((e+1)/n),c.push((S+1)/n),l.push(d[S][e].x),l.push(d[S][e].y),l.push(d[S][e].z),l.push(d[S+1][e+1].x),l.push(d[S+1][e+1].y),l.push(d[S+1][e+1].z),l.push(d[S][e+1].x),l.push(d[S][e+1].y),l.push(d[S][e+1].z),c.push(e/n),c.push(S/n),c.push((e+1)/n),c.push((S+1)/n),c.push((e+1)/n),c.push(S/n);for(let e=0;e<6;e++)a.push(0),a.push(0),a.push(1)}const m={geometry:null,object:null};m.geometry=new nt.u9r;const u=new Float32Array(l),_=new Float32Array(a),p=new Float32Array(c);m.geometry.setAttribute("position",new nt.TlE(u,3)),m.geometry.setAttribute("normal",new nt.TlE(_,3)),m.geometry.setAttribute("uv",new nt.TlE(p,2));const j=new nt.vBJ({side:nt.ehD,transparent:!0,opacity:.75,color:16776415});return j.map=this._textures[r.texture],m.object=new nt.Kj0(m.geometry,j),this._scene.add(m.object),m}_calcDivideCutPoints(e,t,o,i,s){const r=[],n=30,l=new nt.Pa4(1,0,0),a=new nt.Pa4(0,1,0),c=new nt.Pa4(0,0,1),d=(t[i]-o[i])/n;for(let h=0;h<=n;h++){const o=t.clone();o[i]-=d*h,o.applyAxisAngle(l,s.rotation.x),o.applyAxisAngle(a,s.rotation.y),o.applyAxisAngle(c,s.rotation.z);const n=this._calcHitPoint(e,o);r.push(n)}return r}_createRayLine(e,t,o){const i=this._calcHitPoint(e,t),s=[e,i],r={geometry:null,object:null};r.geometry=new lt.VJ,r.geometry.setPoints(s);const n=new lt.r7({color:5263438,lineWidth:o?.5:.2,transparent:!o,opacity:.5});return r.object=new nt.Kj0(r.geometry,n),this._scene.add(r.object),r}_createAllBoundLine(){this._projectors.forEach((e=>{this._createBoundLine(e.name)}))}_calcHitPoint(e,t){const o=t.normalize(),i=new nt.iMs(e,o),s=[this._room.objects.back,this._room.objects.front,this._room.objects.left,this._room.objects.right,this._room.objects.top,this._room.objects.bottom,this._screen.object,...this._screen.object.children],r=i.intersectObjects(s);return 0===r.length?null:(r[0].point.x-=o.x,r[0].point.y-=o.y,r[0].point.z-=o.z,r[0].point)}_calcHitDistance(e,t){const o=this._calcHitPoint(e,t);return o.distanceTo(e)}}class ht extends dt{constructor(e){super(),this._init(e)}_init(e){this._initRenderer(e),this._initScene(),this._initControls(),this._initTransformControl(),this._initTexture().then((()=>{this._initRoom(),this._initScreen()})),this.setTheme()}setScreen(e){this._screenType=e,this._initScreen(),this._screen.object.updateMatrixWorld(),this._createAllBoundLine()}setRoomSize(){this._initRoom(),this._initLight()}setScreenPosition(){this._screen.object.position.x=tt.default.state.screen.x*this._roomSize.ratio,this._screen.object.position.y=tt.default.state.screen.y*this._roomSize.ratio,this._screen.object.position.z=tt.default.state.screen.z*this._roomSize.ratio,this._screen.object.rotation.x=tt.default.state.screen.rotateX/180*Math.PI,this._screen.object.rotation.y=tt.default.state.screen.rotateY/180*Math.PI,this._screen.object.rotation.z=tt.default.state.screen.rotateZ/180*Math.PI,this._screen.object.updateMatrixWorld(),this._createAllBoundLine()}addProjector(e){this._addProjecotr(e).then((e=>{this._projectors.push(e),tt.default.commit("projector/SET_SELECTED_PROJECTOR_X",e.position.x/this._roomSize.ratio),tt.default.commit("projector/SET_SELECTED_PROJECTOR_Y",e.position.y/this._roomSize.ratio),tt.default.commit("projector/SET_SELECTED_PROJECTOR_Z",e.position.z/this._roomSize.ratio),this._createAllBoundLine()}))}setProjector(e){this._setTransformControl(e.uId);const t=this._projectors.find((t=>t.name===e.uId));t.position.x=e.x*this._roomSize.ratio,t.position.y=e.y*this._roomSize.ratio,t.position.z=e.z*this._roomSize.ratio,t.rotation.x=e.rotateX/180*Math.PI,t.rotation.y=e.rotateY/180*Math.PI,t.rotation.z=e.rotateZ/180*Math.PI,this._createAllBoundLine()}setProjectors(e){e.forEach((e=>{const t=this._projectors.find((t=>t.name===e.uId));t.position.x=e.x*this._roomSize.ratio,t.position.y=e.y*this._roomSize.ratio,t.position.z=e.z*this._roomSize.ratio,t.rotation.x=e.rotateX/180*Math.PI,t.rotation.y=e.rotateY/180*Math.PI,t.rotation.z=e.rotateZ/180*Math.PI})),this._createAllBoundLine()}deleteProjector(e){const t=this._projectors.find((t=>t.name===e));this._transformControl.object===t&&this._transformControl.detach(),this._disposeBoundLine(e),this._scene.remove(t)}setProjectorTexture({patternSrc:e,isVideo:t}){tt.default.commit("projector/SET_SELECTED_PROJECTOR_TEXTURE",e),!this._textures[e]&&e?this._loadTexture(e,t).then((t=>{this._textures[e]=t,this._createAllBoundLine()})):this._createAllBoundLine()}getDataUrl(){this._renderer.preserveDrawingBuffer=!0,this._render();const e=this._renderer.domElement.toDataURL("image/jpeg");return this._renderer.preserveDrawingBuffer=!1,e}}let mt=null;const ut={name:"PageIndex",components:{ProjectorDetail:et},created(){this.$bus.on("setScreen",this.setScreen),this.$bus.on("setScreenPosition",this.setScreenPosition),this.$bus.on("autoAdjustScreenPosition",this.autoAdjustScreenPosition),this.$bus.on("setRoomSize",this.setRoomSize),this.$bus.on("addProjector",this.addProjector),this.$bus.on("setProjector",this.setProjector),this.$bus.on("setProjectors",this.setProjectors),this.$bus.on("deleteProjector",this.deleteProjector),this.$bus.on("setProjectorTexture",this.setProjectorTexture),this.$bus.on("initThreeViewImage",this.initThreeViewImage)},beforeUnmount(){this.$bus.off("setScreen",this.setScreen),this.$bus.off("setScreenPosition",this.setScreenPosition),this.$bus.off("autoAdjustScreenPosition",this.autoAdjustScreenPosition),this.$bus.off("setRoomSize",this.setRoomSize),this.$bus.off("addProjector",this.addProjector),this.$bus.off("setProjector",this.setProjector),this.$bus.off("setProjectors",this.setProjectors),this.$bus.off("deleteProjector",this.deleteProjector),this.$bus.off("setProjectorTexture",this.setProjectorTexture),this.$bus.off("initThreeViewImage",this.initThreeViewImage)},mounted(){mt=new ht("#threeView"),mt.animate()},data(){return{view:null}},methods:a()(a()({},(0,c.OI)("common",["SET_THREE_VIEW_IMAGE"])),{},{stylePage(e,t){return{height:t-e+"px"}},resizeCanvas(){mt.onWindowResize()},setRoomSize(){mt.setRoomSize()},setScreen(e){mt.setScreen(e)},setScreenPosition(){mt.setScreenPosition()},autoAdjustScreenPosition(){mt.adjustScreenPosition()},addProjector(e){mt.addProjector(e)},setProjector(e){mt.setProjector(e)},setProjectors(e){mt.setProjectors(e)},deleteProjector(e){mt.deleteProjector(e)},setProjectorTexture(e){mt.setProjectorTexture(e)},initThreeViewImage(){const e=mt.getDataUrl();this.SET_THREE_VIEW_IMAGE(e)}})};var _t=o(24379),pt=o(15151);ut.render=n,ut.__scopeId="data-v-10d8ae1e";const jt=ut;Ke()(ut,"components",{QPage:_t.Z,QResizeObserver:pt.Z})}}]);